---
const { title = "Portfolio" } = Astro.props;
const basePath = (import.meta.env.BASE_URL || "/").replace(/\/$/, "") || "/";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>

    <style is:global>
      :root{
        --bg: #f6f7f8;
        --text: #0a0a0a;
        --muted: rgba(10,10,10,0.60);

        --surface: rgba(255,255,255,0.85);
        --shadow: 0 18px 60px rgba(10,10,10,0.08);
        --shadow2: 0 10px 28px rgba(10,10,10,0.06);

        --r: 18px;
        --max: 1200px;
      }

      *{ box-sizing:border-box; }
      html{ scroll-behavior: smooth; }
      body{
        margin:0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
        background: var(--bg);
        color: var(--text);
      }
      a{ color: inherit; }

      /* === FULL-WIDTH TOP BAR === */
      .topbar{
        position: fixed;
        top:0;
        left:0;
        right:0;
        z-index: 999;
        background: rgba(255,255,255,0.80);
        backdrop-filter: blur(14px);
        -webkit-backdrop-filter: blur(14px);
        box-shadow: 0 1px 0 rgba(10,10,10,0.06);
      }

      .topbarInner{
        max-width: var(--max);
        margin: 0 auto;
        padding: 14px 18px;
        display:flex;
        align-items:center;
        gap: 14px;
      }

      .brand{
        font-weight: 950;
        letter-spacing: -0.02em;
        text-decoration:none;
        white-space: nowrap;
      }

      /* nav on the RIGHT */
      .navlinks{
        margin-left: auto;
        display:flex;
        gap: 18px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      .navlinks a{
        text-decoration:none;
        font-weight: 850;
        color: rgba(10,10,10,0.70);
        padding: 6px 2px;
      }
      .navlinks a:hover{
        color: rgba(10,10,10,0.92);
        text-decoration: underline;
        text-underline-offset: 6px;
      }

      /* content spacing because of fixed bar */
      main{
        max-width: var(--max);
        margin: 0 auto;
        padding: 92px 18px 70px;
      }
      section{ scroll-margin-top: 96px; }

      /* section headings — scroll target so title stays visible below fixed bar */
      .sectionTitle{
        scroll-margin-top: 96px;
        margin: 80px 0 20px;
        font-size: 35px;
        font-weight: 1000;
        letter-spacing: -0.03em;
      }
      .sub{
        margin: 0 0 18px;
        color: var(--muted);
        font-size: inherit;
        line-height: 1.7;
      }

      /* scroll reveal: slide-up + scale + fade (more obvious) */
      .reveal{
        opacity: 0;
        transform: translateY(32px) scale(0.98);
        filter: blur(4px);
        transition: opacity 0.8s cubic-bezier(0.22, 1, 0.36, 1), transform 0.8s cubic-bezier(0.22, 1, 0.36, 1), filter 0.6s ease;
      }
      .reveal.in{
        opacity: 1;
        transform: translateY(0) scale(1);
        filter: blur(0);
      }

      /* minimal cards: NO borders */
      .card{
        border-radius: var(--r);
        background: rgba(255,255,255,0.88);
        box-shadow: var(--shadow2);
      }

      /* hover animation for project/research cards */
      .lift{
        transition: transform .18s ease, box-shadow .18s ease;
      }
      .lift:hover{
        transform: translateY(-6px);
        box-shadow: var(--shadow);
      }

      /* grids */
      .grid3{
        display:grid;
        grid-template-columns: 1fr;
        gap: 16px;
      }
      @media (min-width: 980px){
        .grid3{ grid-template-columns: repeat(3, 1fr); }
      }

      /* media */
      .media{
        width: 100%;
        aspect-ratio: 16/10;
        border-radius: 16px;
        overflow:hidden;
        background: #fff;
      }
      .media img, .media video{
        width:100%;
        height:100%;
        display:block;
        object-fit: cover;
      }
      .contain img{ object-fit: contain; }
      .contain video{ object-fit: cover; }

      /* chips */
      .pillRow{
        margin-top: 10px;
        display:flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .pill{
        padding: 6px 10px;
        border-radius: 999px;
        background: rgba(10,10,10,0.05);
        font-weight: 500;
        font-size: .92rem;
        color: rgba(10,10,10,0.74);
      }

      /* === SKILLS (NO CARD LOOK) === */
      .skillsGrid{
        display:grid;
        gap: 10px;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        align-items: stretch;
        justify-items: stretch;
      }
      .skillChip{
        display:flex;
        align-items:center;
        justify-content:center;
        gap: 10px;
        padding: 12px 14px;
        border-radius: 999px;
        background: rgba(10,10,10,0.04); /* no card */
        font-weight: 900;
        color: rgba(10,10,10,0.82);
        transition: transform .16s ease, box-shadow .16s ease, background .16s ease, color .16s ease;
        user-select:none;
      }
      .skillChip:hover{
        transform: translateY(-3px);
        box-shadow: var(--shadow2); /* lift on hover */
        background: #0a0a0a;
        color: #fff;
      }
      .skillChip img{
        width: 18px;
        height: 18px;
        display:block;
        filter: grayscale(1) contrast(1.25);
      }
      .skillChip:hover img{
        filter: invert(1) grayscale(1) contrast(1.25);
      }

      footer{
        margin-top: 70px;
        color: rgba(10,10,10,0.52);
        font-size: 14px;
      }
    </style>

    <script is:inline>
      document.addEventListener('DOMContentLoaded', () => {
        const els = document.querySelectorAll('.reveal');
        const io = new IntersectionObserver((entries) => {
          for (const e of entries) {
            if (e.isIntersecting) {
              e.target.classList.add('in');
              io.unobserve(e.target);
            }
          }
        }, { threshold: 0.14 });
        els.forEach(el => io.observe(el));
      });
    </script>
  </head>

  <body>
    <header class="topbar">
      <div class="topbarInner">
        <a class="brand" href={basePath}>Annan Fu</a>

        <nav class="navlinks">
          <a href={`${basePath}#about`}>About</a>
          <a href={`${basePath}#skills`}>Skills</a>
          <a href={`${basePath}#projects`}>Projects</a>
          <a href={`${basePath}#research`}>Research</a>
          <a href={`${basePath}#connect`}>Connect</a>
        </nav>
      </div>
    </header>

    <main id="top">
      <slot />
      <footer>© {new Date().getFullYear()} Annan Fu</footer>
    </main>
  </body>
</html>
